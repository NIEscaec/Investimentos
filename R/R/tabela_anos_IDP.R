#' @export

library(Investimentos)
library(tidyr)
library(dplyr)
library(readxl)



#=============================================================================================================================================================

                                                                   # ANO 2020

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2020_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A5:AJ20")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  linhas <- c(1, 2, 3, 7, 10, 11, 13, 15)
  ANO_2020_CF <- ANO_2020_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------
  ANO_2020_CF <- ANO_2020_CF %>% mutate(dplyr::across(.cols=2:36, .fns=as.numeric))
  #ANO_2020_CF <- turn_numeric(ANO_2020_CF, 36)

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2020_CF <- ANO_2020_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Indonésia,
      names_to = "pais",
      values_to = "valor")

#====================================================================================================================================================================

                                                                          # ANO 2019

  #----------------------------------------------------------------------

  ANO_2019_CF <-  read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A27:AJ42")

  #----------------------------------------------------------------------

  ANO_2019_CF <- ANO_2019_CF[-linhas, ]

  #----------------------------------------------------------------------


  ANO_2019_CF <- ANO_2019_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:`Emirados Árabes Unidos`,
      names_to = "pais",
      values_to = "valor")


#=============================================================================================================================================================

                                                                           # ANO 2018

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2018_CF <-  read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A48:AJ63")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2018_CF <- ANO_2018_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2018_CF <- ANO_2018_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Dinamarca,
      names_to = "pais",
      values_to = "valor")

#====================================================================================================================================================================

                                                                         # ANO 2017

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2017_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A70:AJ85")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2017_CF <- ANO_2017_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2017_CF <- ANO_2017_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Finlândia,
      names_to = "pais",
      values_to = "valor")


#====================================================================================================================================================================


  #                                                                         ANO 2016

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2016_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A92:AJ107")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2016_CF <- ANO_2016_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2016_CF <- ANO_2016_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Israel,
      names_to = "pais",
      values_to = "valor")


#====================================================================================================================================================================


  #                                                                         ANO 2015

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2015_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A112:AJ127")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2015_CF <- ANO_2015_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2015_CF <- ANO_2015_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Áustria,
      names_to = "pais",
      values_to = "valor")

#===================================================================================================================================================================


  #                                                                         ANO 2014

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2014_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A132:AJ147")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2014_CF <- ANO_2014_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2014_CF <- ANO_2014_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:Colômbia,
      names_to = "pais",
      values_to = "valor")

#===================================================================================================================================================================


  #                                                                         ANO 2013

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2013_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A152:AJ167")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2013_CF <- ANO_2013_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2013_CF <- ANO_2013_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:`África do Sul`,
      names_to = "pais",
      values_to = "valor")

#===================================================================================================================================================================
  #                                                                         ANO 2012

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2012_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx", sheet = "14", range = "A172:AJ187")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2012_CF <- ANO_2012_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2012_CF <- ANO_2012_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:"Bahamas",
      names_to = "pais",
      values_to = "valor")

#===================================================================================================================================================================
  #                                                                         ANO 2011

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2011_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx", sheet = "14", range = "A192:AJ207")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2011_CF <- ANO_2011_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2011_CF <- ANO_2011_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:`Ilha de Man`,
      names_to = "pais",
      values_to = "valor")

  #===================================================================================================================================================================
  #                                                                         ANO 2010

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2010_CF <- read_xlsx("data-raw/TabelasCompletasPosicaoIDP.xlsx",sheet = "14", range = "A212:AJ227")

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2010_CF <- ANO_2010_CF[-linhas, ]

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  ANO_2010_CF <- ANO_2010_CF %>%
    pivot_longer(
      cols = `Estados Unidos`:"Angola",
      names_to = "pais",
      values_to = "valor")

  #===================================================================================================================================================================

  # Adiciona a coluna anos
  ANO_2010_CF$Ano <- "2010"
  ANO_2010_CF$Ano <- as.numeric(ANO_2010_CF$Ano)

  ANO_2011_CF$Ano <- "2011"
  ANO_2011_CF$Ano <- as.numeric(ANO_2011_CF$Ano)

  ANO_2012_CF$Ano <- "2012"
  ANO_2012_CF$Ano <- as.numeric(ANO_2012_CF$Ano)

  ANO_2013_CF$Ano <- "2013"
  ANO_2013_CF$Ano <- as.numeric(ANO_2013_CF$Ano)

  ANO_2014_CF$Ano <- "2014"
  ANO_2014_CF$Ano <- as.numeric(ANO_2014_CF$Ano)

  ANO_2015_CF$Ano <- "2015"
  ANO_2015_CF$Ano <- as.numeric(ANO_2015_CF$Ano)

  ANO_2016_CF$Ano <- "2016"
  ANO_2016_CF$Ano <- as.numeric(ANO_2016_CF$Ano)

  ANO_2017_CF$Ano <- "2017"
  ANO_2017_CF$Ano <- as.numeric(ANO_2017_CF$Ano)

  ANO_2018_CF$Ano <- "2018"
  ANO_2018_CF$Ano <- as.numeric(ANO_2018_CF$Ano)

  ANO_2019_CF$Ano <- "2019"
  ANO_2019_CF$Ano <- as.numeric(ANO_2019_CF$Ano)

  ANO_2020_CF$Ano <- "2020"
  ANO_2020_CF$Ano <- as.numeric(ANO_2020_CF$Ano)

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

  # renomeia a coluna setor
  ANO_2010_CF <- ANO_2010_CF %>%
    rename("Setores" = `ANO: 2010`)

  ANO_2011_CF <- ANO_2011_CF %>%
    rename("Setores" = `ANO: 2011`)

  ANO_2012_CF <- ANO_2012_CF %>%
    rename("Setores" = `ANO: 2012`)

  ANO_2013_CF <- ANO_2013_CF %>%
    rename("Setores" = `ANO: 2013`)

  ANO_2014_CF <- ANO_2014_CF %>%
    rename("Setores" = `ANO: 2014`)

  ANO_2015_CF <- ANO_2015_CF %>%
    rename("Setores" = `ANO: 2015`)

  ANO_2016_CF <- ANO_2016_CF %>%
    rename("Setores" = `ANO: 2016`)

  ANO_2017_CF <- ANO_2017_CF %>%
    rename("Setores" = `ANO: 2017`)

  ANO_2018_CF <- ANO_2018_CF %>%
    rename("Setores" = `ANO: 2018`)

  ANO_2019_CF <- ANO_2019_CF %>%
    rename("Setores" = `ANO: 2019`)

  ANO_2020_CF <- ANO_2020_CF %>%
    rename("Setores" = `ANO: 2020`)

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------
  # junat em data frame só
  IDP_Por_Setor_Control_Final <- bind_rows(ANO_2020_CF, ANO_2019_CF, ANO_2018_CF, ANO_2017_CF, ANO_2016_CF, ANO_2015_CF, ANO_2014_CF, ANO_2013_CF, ANO_2012_CF, ANO_2011_CF, ANO_2010_CF)

  #-----------------------------------------------------------------------------------------------------------------------------------------------------------

